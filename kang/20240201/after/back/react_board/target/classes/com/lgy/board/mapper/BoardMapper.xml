<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lgy.board.dao.BoardDao">

    <select id="list" resultType="com.lgy.board.dto.BoardDto">
        SELECT * FROM BOARDD ORDER BY TO_NUMBER(boardNum) DESC
    </select>

    <select id="getHit" resultType="com.lgy.board.dto.BoardDto">
        <![CDATA[
        SELECT * FROM (
            SELECT board.*,
                   ROW_NUMBER() OVER (ORDER BY TO_NUMBER(boardHit) DESC, TO_NUMBER(boardNum) DESC) AS rnum
            FROM BOARDD board
        ) WHERE rnum <= 5
        ]]>
    </select>
    <select id="getBoardListPaging" parameterType="java.util.Map" resultType="com.lgy.board.dto.BoardDto">
    <![CDATA[
        SELECT * 
        FROM (
            SELECT 
                ROWNUM AS rnum, 
                boardNum, 
                boardTitle, 
                boardWriter, 
                boardDate, 
                boardHit 
            FROM (
                SELECT 
                    boardNum, 
                    boardTitle, 
                    boardWriter, 
                    boardDate, 
                    boardHit 
                FROM BOARDD 
                ORDER BY TO_NUMBER(boardNum) DESC
            )
            WHERE ROWNUM <= #{end}
        )
        WHERE rnum >= #{start} AND rnum <= #{end}
    ]]>
</select>
    
<select id="getBoardWriter" parameterType="java.util.Map" resultType="com.lgy.board.dto.BoardDto">
  <![CDATA[
    SELECT * 
    FROM (
      SELECT 
        ROWNUM AS rnum, 
        boardNum, 
        boardTitle, 
        boardWriter, 
        boardDate, 
        boardHit 
      FROM (
        SELECT 
          boardNum, 
          boardTitle, 
          boardWriter, 
          boardDate, 
          boardHit 
        FROM BOARDD 
        WHERE 
          UPPER(boardWriter) LIKE '%' || UPPER(#{searchVal}) || '%'  -- 대소문자 구분하지 않음
          AND INSTR(UPPER(boardWriter), UPPER(#{searchVal})) > 0  -- 문자열이 포함되어 있는지 확인
        ORDER BY TO_NUMBER(boardNum) DESC
      )
      WHERE ROWNUM <= #{end}
    )
    WHERE rnum BETWEEN #{start} AND #{end}
  ]]>
</select>

<select id="getBoardTitle" parameterType="java.util.Map" resultType="com.lgy.board.dto.BoardDto">
	 	    <![CDATA[
        SELECT * 
        FROM (
            SELECT 
                ROWNUM AS rnum, 
                boardNum, 
                boardTitle, 
                boardWriter, 
                boardDate, 
                boardHit 
            FROM (
                SELECT 
                    boardNum, 
                    boardTitle, 
                    boardWriter, 
                    boardDate, 
                    boardHit 
                FROM BOARDD 
                WHERE boardTitle LIKE '%' || #{searchVal} || '%'
                ORDER BY TO_NUMBER(boardNum) DESC
            )
            WHERE ROWNUM <= #{end}
        )
        WHERE rnum >= #{start} AND rnum <= #{end}
    ]]>
</select>
<select id="getCateMenu1" parameterType="java.util.Map" resultType="com.lgy.board.dto.BoardDto">
    <![CDATA[
        SELECT *
        FROM (
            SELECT
                boardNum,
                boardTitle,
                boardWriter,
                boardDate,
                boardHit,
                ROWNUM AS rnum
            FROM (
                SELECT
                    boardNum,
                    boardTitle,
                    boardWriter,
                    boardDate,
                    boardHit
                FROM BOARDD
                WHERE cate = TO_NUMBER(#{catemenu})
                ORDER BY TO_NUMBER(boardNum) DESC
            )
            WHERE ROWNUM <= TO_NUMBER(#{end})
        )
        WHERE rnum >= TO_NUMBER(#{start})
    ]]>
</select>
<select id="getCateMenu2" parameterType="java.util.Map" resultType="com.lgy.board.dto.BoardDto">
	 <![CDATA[
        SELECT *
        FROM (
            SELECT
                boardNum,
                boardTitle,
                boardWriter,
                boardDate,
                boardHit,
                ROWNUM AS rnum
            FROM (
                SELECT
                    boardNum,
                    boardTitle,
                    boardWriter,
                    boardDate,
                    boardHit
                FROM BOARDD
                WHERE cate = TO_NUMBER(#{catemenu})
                ORDER BY TO_NUMBER(boardNum) DESC
            )
            WHERE ROWNUM <= TO_NUMBER(#{end})
        )
        WHERE rnum >= TO_NUMBER(#{start})
    ]]>
</select>
<select id="getCateMenu3" parameterType="java.util.Map" resultType="com.lgy.board.dto.BoardDto">
	 <![CDATA[
        SELECT *
        FROM (
            SELECT
                boardNum,
                boardTitle,
                boardWriter,
                boardDate,
                boardHit,
                ROWNUM AS rnum
            FROM (
                SELECT
                    boardNum,
                    boardTitle,
                    boardWriter,
                    boardDate,
                    boardHit
                FROM BOARDD
                WHERE cate = TO_NUMBER(#{catemenu})
                ORDER BY TO_NUMBER(boardNum) DESC
            )
            WHERE ROWNUM <= TO_NUMBER(#{end})
        )
        WHERE rnum >= TO_NUMBER(#{start})
    ]]>
</select>


<select id="getCSearch1" parameterType="java.util.Map" resultType="com.lgy.board.dto.BoardDto">
     <![CDATA[
        SELECT *
FROM (
    SELECT 
        boardNum,
        boardTitle,
        boardWriter,
        boardDate,
        boardHit,
        ROWNUM AS rnum
    FROM (
        SELECT
            boardNum,
            boardTitle,
            boardWriter,
            boardDate,
            boardHit
        FROM BOARDD
        WHERE CATE = TO_NUMBER(#{catemenu2})
        ORDER BY TO_NUMBER(boardNum) DESC
    )
    WHERE 
        UPPER (${cateSelec}) LIKE '%' || #{cateVal} || '%'
        AND INSTR(UPPER(${cateSelec}), UPPER(#{cateVal})) > 0  

)
WHERE rnum <= TO_NUMBER(#{end}) AND rnum >= TO_NUMBER(#{start})

    ]]>
  
</select>


<select id="getCSearch2" parameterType="java.util.Map" resultType="com.lgy.board.dto.BoardDto">
   <![CDATA[
        SELECT *
FROM (
    SELECT 
        boardNum,
        boardTitle,
        boardWriter,
        boardDate,
        boardHit,
        ROWNUM AS rnum
    FROM (
        SELECT
            boardNum,
            boardTitle,
            boardWriter,
            boardDate,
            boardHit
        FROM BOARDD
        WHERE CATE = TO_NUMBER(#{catemenu2})
        ORDER BY TO_NUMBER(boardNum) DESC
    )
    WHERE 
        UPPER (${cateSelec}) LIKE '%' || #{cateVal} || '%'
        AND INSTR(UPPER(${cateSelec}), UPPER(#{cateVal})) > 0  

)
WHERE rnum <= TO_NUMBER(#{end}) AND rnum >= TO_NUMBER(#{start})

    ]]>
  
</select>
<select id="getCSearch3" parameterType="java.util.Map" resultType="com.lgy.board.dto.BoardDto">
   <![CDATA[
        SELECT *
FROM (
    SELECT 
        boardNum,
        boardTitle,
        boardWriter,
        boardDate,
        boardHit,
        ROWNUM AS rnum
    FROM (
        SELECT
            boardNum,
            boardTitle,
            boardWriter,
            boardDate,
            boardHit
        FROM BOARDD
        WHERE CATE = TO_NUMBER(#{catemenu2})
        ORDER BY TO_NUMBER(boardNum) DESC
    )
    WHERE 
        UPPER (${cateSelec}) LIKE '%' || #{cateVal} || '%'
        AND INSTR(UPPER(${cateSelec}), UPPER(#{cateVal})) > 0  

)
WHERE rnum <= TO_NUMBER(#{end}) AND rnum >= TO_NUMBER(#{start})

    ]]>
  
</select>




</mapper>
